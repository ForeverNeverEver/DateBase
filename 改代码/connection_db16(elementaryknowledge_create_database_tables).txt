import MySQLdb

config = {
‘host’: ‘127.0.0.1’,
‘port’: 3306,
‘user’: ‘root’,
‘passwd:'',
‘charset’:‘utf8’,

}
conn = MySQLdb.connect(**config)

cursor = conn.cursor()

try:

#创建数据库
DB_NAME = ‘bank_info’
cursor.execute(‘DROP DATABASE IF EXISTS %s’ %DB_NAME)
cursor.execute(‘CREATE DATABASE IF NOT EXISTS %s’ %DB_NAME)
conn.select_db(DB_NAME)

#在数据库下创建表
TABLE_NAME = ‘bankData’
cursor.execute(‘CREATE TABLE %s(id int primary key,money int(30))’ %TABLE_NAME)

#批量插入纪录
values = []
for i in range(20):
values.append((int(i),int(156*i)))
cursor.executemany(‘INSERT INTO bankData values(%s,%s)’,values)
conn.commit()
#查询数据条目
count = cursor.execute(‘SELECT * FROM %s’ %TABLE_NAME)
print (‘total records:{}’.format(cursor.rowcount))


#获取表名信息
desc = cursor.description
print ("%s %3s" % (desc[0][0], desc[1][0]))

cursor.scroll(10,mode=‘absolute’)
results = cursor.fetchall()
for result in results:
print (result)

except:
import traceback
traceback.print_exc()


#发生错误时会滚
conn.rollback()
finally:

#关闭游标连接
cursor.close()

#关闭数据库连接
conn.close()